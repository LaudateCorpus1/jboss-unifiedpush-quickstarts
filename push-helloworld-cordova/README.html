<!DOCTYPE html><html><head><title>README</title><link href="http://static.jboss.org/ffe/0/www/vendor/redhat/documentation.css" rel="stylesheet"></link><link href="http://static.jboss.org/ffe/0/www/vendor/redhat/pygments.css" rel="stylesheet"></link></head><body>
<h1><a id="pushhelloworldcordova-helloworld-jboss-unified-push-cordova-push-plugin" class="anchor" href="#pushhelloworldcordova-helloworld-jboss-unified-push-cordova-push-plugin"><span class="anchor-icon"></span></a>push-helloworld-cordova: Helloworld JBoss Unified Push Cordova Push Plug-in</h1>

<p>Author: Erik Jan de Wit (edewit)<br/>
Level: Beginner<br/>
Technologies: JavaScript Cordova<br/>
Summary: The <code>push-helloworld-cordova</code> quickstart shows how to use the JBoss Unified Push Cordova Push plug-in to register and receive push notifications.<br/>
Target Product: JBoss Unified Push<br/>
Versions: 1.0<br/>
Source: <a href="https://github.com/jboss-developer/jboss-mobile-quickstarts/">https://github.com/jboss-developer/jboss-mobile-quickstarts/</a>  </p>

<h2><a id="what-is-it" class="anchor" href="#what-is-it"><span class="anchor-icon"></span></a>What is it?</h2>

<p>The <code>push-helloworld-cordova</code> quickstart demonstrates how to include basic push functionality in Cordova applications using the JBoss Unified Push Cordova Push plug-in.</p>

<p>This simple project consists of a ready-to-build Cordova application. Before building the application, you must register the Android or iOS variant of the application with a running JBoss Unified Push Server OpenShift instance and Google Cloud Messaging for Android or Apple Push Notification Service for iOS. The resulting unique IDs and other parameters must then be inserted into the application source code. After this is complete, the application can be built and deployed to Android or iOS devices.</p>

<p>When the application is deployed to an Android or iOS device, the push functionality enables the device to register with the running JBoss Unified Push Server instance and receive push notifications.</p>

<h2><a id="how-do-i-run-it" class="anchor" href="#how-do-i-run-it"><span class="anchor-icon"></span></a>How do I run it?</h2>

<h3><a id="0-system-requirements" class="anchor" href="#0-system-requirements"><span class="anchor-icon"></span></a>0. System requirements</h3>

<p>The Cordova command line tooling is based on node.js so first you&rsquo;ll need to <a href="http://nodejs.org/download/">install node</a>, then you can install Cordova by executing:</p>
<div class="highlight"><pre><span class="w">    </span><span class="vg">npm</span><span class="w"> </span><span class="vg">install</span><span class="w"> </span><span class="o">-</span><span class="vg">g</span><span class="w"> </span><span class="vg">cordova</span>
</pre></div>
<p>To deploy on iOS you need to install the ios-deploy package as well</p>
<div class="highlight"><pre><span class="w">    </span><span class="vg">npm</span><span class="w"> </span><span class="vg">install</span><span class="w"> </span><span class="o">-</span><span class="vg">g</span><span class="w"> </span><span class="vg">ios</span><span class="o">-</span><span class="vg">deploy</span>
</pre></div>
<h4><a id="" class="anchor" href="#"><span class="anchor-icon"></span></a>iOS</h4>

<p>For iOS you&rsquo;ll need a valid provisioning profile as you will need to test on an actual device (push notification is not available when using a simulator).
Replace the bundleId with your bundleId (the one associated with your certificate), by editing the config.xml at the root of this project, change the id attribute of the <code>widget</code> node. After that run a <code>cordova platform rm ios</code> followed by <code>cordova platform add ios</code> to change the Xcode project template.</p>

<p>If you want to change your bundleId later on, you will still have to run a <code>cordova platform rm ios</code> followed by <code>cordova platform add ios</code> to change the Xcode project template.</p>

<h4><a id="android" class="anchor" href="#android"><span class="anchor-icon"></span></a>Android</h4>

<p>To deploy and run Cordova applications on Android, the Apache Ant tool needs to be <a href="http://ant.apache.org/manual/install.html">installed</a>.</p>

<h3><a id="1-register-application-with-push-services" class="anchor" href="#1-register-application-with-push-services"><span class="anchor-icon"></span></a>1. Register Application with Push Services</h3>

<p>For the configuration and registration of Android or iOS Applications with push services, please refer to the specific guides inside <em>push-helloworld-android</em> and <em>push-helloworld-ios</em> quickstarts.</p>

<h3><a id="2-customize-and-build-application" class="anchor" href="#2-customize-and-build-application"><span class="anchor-icon"></span></a>2. Customize and Build Application</h3>

<p>In <code>www/push-config.json</code> change <code>pushServerURL</code> with the url of your Unified Push Server OpenShift instance. You also need to change <code>senderID</code>, <code>variantID</code> and <code>variantSecret</code> with the values assigned by Unified Push Server OpenShift instance and GCM or APNS:</p>
<div class="highlight"><pre><span class="w">    </span><span class="p">{</span>
<span class="w">       </span><span class="s2">&quot;pushServerURL&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;&lt;pushServerURL e.g https://{OPENSHIFT_UNIFIEDPUSHSERVER_URL}/ag-push &gt;&quot;</span><span class="p">,</span>
<span class="w">       </span><span class="s2">&quot;android&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="s2">&quot;senderID&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;&lt;senderID e.g Google Project ID only for android&gt;&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;variantID&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;&lt;variantID e.g. 1234456-234320&gt;&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;variantSecret&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;&lt;variantSecret e.g. 1234456-234320&gt;&quot;</span>
<span class="w">       </span><span class="p">},</span>
<span class="w">       </span><span class="s2">&quot;ios&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="s2">&quot;variantID&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;&lt;variantID e.g. 1234456-234320&gt;&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;variantSecret&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;&lt;variantSecret e.g. 1234456-234320&gt;&quot;</span>
<span class="w">       </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
<p><strong>Note:</strong> You can also copy/paste these settings from your Unified Push Server console</p>

<h3><a id="3-install-platforms" class="anchor" href="#3-install-platforms"><span class="anchor-icon"></span></a>3. Install platforms</h3>

<p>After changing the push configuration you can install the platforms you want on the Cordova app. JBoss Unified Push for Cordova currently supports Android and iOS.</p>
<div class="highlight"><pre><span class="w">    </span><span class="vg">cordova</span><span class="w"> </span><span class="vg">platform</span><span class="w"> </span><span class="vg">add</span><span class="w"> </span><span class="o">&lt;</span><span class="vg">android</span><span class="w"> </span><span class="vg">or</span><span class="w"> </span><span class="vg">ios</span><span class="o">&gt;</span>
</pre></div>
<h3><a id="4-add-jboss-unified-push-cordova-push-plugin" class="anchor" href="#4-add-jboss-unified-push-cordova-push-plugin"><span class="anchor-icon"></span></a>4. Add JBoss Unified Push Cordova Push plug-in</h3>

<p>You now need to add the plugin to the Cordova app.</p>
<div class="highlight"><pre><span class="w">    </span><span class="vg">cordova</span><span class="w"> </span><span class="vg">plugin</span><span class="w"> </span><span class="vg">add</span><span class="w"> </span><span class="err">`</span><span class="vg">QUICKSTART_HOME</span><span class="o">/</span><span class="vg">cordova_pushplugin</span><span class="o">/</span><span class="vg">org</span><span class="o">.</span><span class="vg">jboss</span><span class="o">.</span><span class="vg">aerogear</span><span class="o">.</span><span class="vg">cordova</span><span class="o">.</span><span class="vg">push</span><span class="err">`</span>
</pre></div>
<h3><a id="5-test-the-application" class="anchor" href="#5-test-the-application"><span class="anchor-icon"></span></a>5. Test the Application</h3>

<p>The application can be tested on physical Android or iOS devices only; push notifications are not available for Android emulators nor iOS simulators. To deploy, run and debug the application on an Android or iOS device attached to your system, on the command line enter the following:</p>
<div class="highlight"><pre><span class="w">    </span><span class="vg">cordova</span><span class="w"> </span><span class="vg">run</span><span class="w"> </span><span class="o">&lt;</span><span class="vg">android</span><span class="w"> </span><span class="vg">or</span><span class="w"> </span><span class="vg">ios</span><span class="o">&gt;</span>
</pre></div>
<h4><a id="send-a-push-message" class="anchor" href="#send-a-push-message"><span class="anchor-icon"></span></a>Send a Push Message</h4>

<p>You can send a push notification to your device using the Unified Push Server console by completing the following steps:</p>

<ol>
<li>Log into the Unified Push Server OpenShift instance console.</li>
<li>Click <code>Send Push</code>.</li>
<li>From the <code>Applications</code> list, select the application.</li>
<li>In the <code>Messages</code> field, type the text to be sent as the push notification.</li>
<li>Click <code>Send Push Notification</code>.</li>
</ol>

<h2><a id="how-does-it-work" class="anchor" href="#how-does-it-work"><span class="anchor-icon"></span></a>How does it work?</h2>

<h3><a id="registration" class="anchor" href="#registration"><span class="anchor-icon"></span></a>Registration</h3>

<p>When you start the application Cordova will fire a <code>deviceready</code> event when Cordova initialization is done and the device is ready (see <code>www/js/index.js</code>). On this event the <code>register</code> function will be executed registering the device with the JBoss Unified Push Server. The first argument is a function that gets executed when the device receives a push event, followed by a success and errorCallback that are invoked when the registration was successful or not and the last parameter is the push configuration that indicates where the push server is located and which variant/secret to use. When registration is successful it will display this on the UI. You can also verify that the registration was successful by going to the console. A new instance will appear with your deviceId, platform and status.</p>

<h2><a id="run-pushhelloworldcordova-in-jboss-developer-studio-or-eclipse" class="anchor" href="#run-pushhelloworldcordova-in-jboss-developer-studio-or-eclipse"><span class="anchor-icon"></span></a>Run push-helloworld-cordova in JBoss Developer Studio or Eclipse</h2>

<p>Import the generated project into JBDS:  </p>

<p><img src="doc/import.png" alt="import"/></p>

<p>Select the project location and project and click <code>Finish</code>:  </p>

<p><img src="doc/import-helloworld.png" alt="import-helloworld"/></p>

<p>In the newly imported project, open the <code>config.xml</code> file and click <code>Add...</code> in the <code>Features</code> section:  </p>

<p><img src="doc/config-add-feature.png" alt="config-add-feature"/></p>

<p>Choose <code>Directory</code> and point to the directory containing your plugin, then click <code>Finish</code>:  </p>

<p><img src="doc/plugin-add.png" alt="plugin-add"/></p>

<p>Run the project on a device:  </p>

<p><img src="doc/run.png" alt="run"/></p>

<h1><a id="debug-the-application" class="anchor" href="#debug-the-application"><span class="anchor-icon"></span></a>Debug the Application</h1>

<ol>
<li><p>Start a browser Chrome for Android or Safari for iOS</p></li>
<li><p>Follow the instructions for the mobile device</p></li>
</ol>

<ul>
<li><p>For iOS</p>
<div class="highlight"><pre><span class="vg">Develop</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="vg">device</span><span class="w"> </span><span class="vg">name</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="vg">index</span><span class="o">.</span><span class="vg">html</span>
</pre></div></li>
<li><p>For Android</p>
<div class="highlight"><pre><span class="vg">Menu</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="vg">Tools</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="vg">Inspect</span><span class="w"> </span><span class="vg">Devices</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="vg">inspect</span>
</pre></div></li>
</ul>
</body></html>
